<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/basic2.html}">
<head>
  <meta charset="UTF-8">
  <title>게시글 수정</title>
  <link th:href="@{/css/common.css}" rel="stylesheet"/>
  <link th:href="@{/css/board.css}" rel="stylesheet" />
</head>

<div class="container" layout:fragment="content">
  <div class="container2">
    <div class="board_main">

      <div class="board_main_box">

        <div class="board_maintext">
          <p class="maintext1">게시물 수정</p>
        </div>

        <div class="board_main_box4">
          <form th:action="@{/board/modify}" method="post" enctype="multipart/form-data">
            <input type="hidden" name="boardId" th:value="${boardDTO.boardId}"/>

            <div class="main-input">
              <label><span>* </span>작성자</label>
              <input type="text" class="txt-input" name="title" th:value="${boardDTO.username}">
            </div>

            <div class="main-input">
              <label><span>* </span>제목</label>
              <input type="text" class="txt-input" name="title" th:value="${boardDTO.title}" required>
            </div>

            <div class="main-textarea">
              <label><span>* </span>게시글 내용</label>
              <textarea name="content" class="txt-textarea" rows="5" th:text="${boardDTO.content}" required></textarea>
            </div>

            <div class="main-input">
              <label><span>* </span>작성 날짜</label>
              <input type="text" class="txt-input"  th:value="${#temporals.format(boardDTO.regDate, 'yyyy-MM-dd HH:mm')}">
            </div>

            <div class="main-input">
              <label><span>* </span>수정 날짜</label>
              <input type="text" class="txt-input"  th:value="${#temporals.format(boardDTO.modDate, 'yyyy-MM-dd HH:mm')}">
            </div>

            <div class="main-input">
              <label><span>* </span>기존 첨부 파일 </label>
              <input type="text" class="txt-input"  th:value="${boardDTO.fileNames}">
<!--              <span th:text="${fileName}" class="me-2">파일 이름</span>-->
<!--              <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeFile(this, '[[${fileName}]]')">삭제</button>-->

<!--              기존 코드-->
<!--              <ul class="list-unstyled">-->
<!--                <li th:each="fileName : ${boardDTO.fileNames}" class="d-flex align-items-center mb-2">-->
<!--                  <span th:text="${fileName}" class="me-2">파일 이름</span>-->
<!--                  <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeFile(this, '[[${fileName}]]')">삭제</button>-->
<!--                </li>-->
<!--              </ul>-->
            </div>

            <div class="main-input">
              <label><span>* </span> 새로운 첨부 파일 추가 </label>
              <input type="file" class="txt-input" name="files" multiple />
            </div>

            <div class="todo_main_btn">
              <button type="submit" class="custom-btn btn_register2">게시글 저장</button>

              <a th:href="@{/board/read(boardId=${boardDTO.boardId})}"  class="text-decoration-none">
                <button type="button" class="custom-btn btn_register2">뒤로 가기</button>
              </a>
              <a th:href="@{/board/remove(boardId=${boardDTO.boardId})}"  class="text-decoration-none">
                <button type="button" class="custom-btn btn_register3">게시글 삭제</button>
              </a>
            </div>






          </form>
        </div>

      </div>


    </div>




  </div>
</div>

<script>

// 기존 스크립트 코드
  // function removeFile(button, fileName) {
  //   const form = button.closest("form");
  //   const input = document.createElement("input");
  //   input.type = "hidden";
  //   input.name = "deletedFiles";
  //   input.value = fileName;
  //   form.appendChild(input);
  //
  //   const li = button.closest("li");
  //   li.remove();
  // }


// 수정 스크립트 코드
  // function removeFile(button, fileName) {
  //   // 현재 파일 삭제를 위한 히든 필드 추가
  //   const form = button.closest("form");
  //
  //   // 삭제된 파일 정보 저장을 위한 hidden input 추가
  //   const input = document.createElement("input");
  //   input.type = "hidden";
  //   input.name = "deletedFiles";  // 서버로 전송될 파라미터 이름
  //   input.value = fileName;       // 삭제될 파일의 이름
  //
  //   form.appendChild(input);
  //
  //   // 파일을 UI에서 삭제 (삭제 버튼 클릭 시 부모의 .main-input을 제거)
  //   const mainInput = button.closest(".main-input");
  //   mainInput.remove(); // 이 부분이 UI에서 파일을 삭제하는 부분입니다.

</script>

</html>
